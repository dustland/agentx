

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>agentx.builtin_tools.web &mdash; AgentX 0.13.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=ec68e10f"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            AgentX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AgentX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">agentx.builtin_tools.web</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for agentx.builtin_tools.web</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Web Tools - Opinionated web automation and content extraction.</span>

<span class="sd">Built-in integrations:</span>
<span class="sd">- Firecrawl: Superior web content extraction (with fallback)</span>
<span class="sd">- requests + BeautifulSoup: Reliable fallback for content extraction</span>
<span class="sd">- browser-use: AI-first browser automation (better than Playwright for agents)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">..utils.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..tool.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tool</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">ToolResult</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..core.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfigurationError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="WebContent">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.WebContent">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">WebContent</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracted web content.&quot;&quot;&quot;</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">markdown</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="BrowserAction">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.BrowserAction">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BrowserAction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Browser automation action result.&quot;&quot;&quot;</span>
    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">screenshot</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="WebTool">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.WebTool">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">WebTool</span><span class="p">(</span><span class="n">Tool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Web content extraction and browser automation tool.</span>
<span class="sd">    </span>
<span class="sd">    Combines Firecrawl for content extraction and browser-use for automation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jina_api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;web&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span> <span class="o">=</span> <span class="n">jina_api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_clients</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_init_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize Jina Reader and browser-use clients.&quot;&quot;&quot;</span>
        <span class="c1"># Initialize Jina Reader</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span><span class="p">:</span>
                <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;JINA_API_KEY&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Jina Reader API key configured&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Jina API key not found. Set JINA_API_KEY environment variable for enhanced features&quot;</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to initialize Jina configuration: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Initialize browser-use</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">browser_use</span><span class="w"> </span><span class="kn">import</span> <span class="n">Browser</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span> <span class="o">=</span> <span class="n">Browser</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;browser-use initialized&quot;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;browser-use not installed. Install with: pip install browser-use&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to initialize browser-use: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<div class="viewcode-block" id="WebTool.extract_content">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.WebTool.extract_content">[docs]</a>
    <span class="nd">@tool</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extract clean content from URLs using Jina Reader&quot;</span><span class="p">,</span>
        <span class="n">return_description</span><span class="o">=</span><span class="s2">&quot;ToolResult containing extracted web content with title and markdown&quot;</span>
    <span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">extract_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Extract the main content from this webpage&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract clean content from one or more URLs using Jina Reader.</span>
<span class="sd">        </span>
<span class="sd">        Jina Reader is specifically designed for AI content extraction and handles</span>
<span class="sd">        anti-bot protection, JavaScript rendering, and modern web challenges.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            urls: A single URL or list of URLs to extract content from</span>
<span class="sd">            prompt: Description of what content to focus on (optional)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            ToolResult with extracted content</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
            
            <span class="c1"># Convert single URL to list</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">urls</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">urls</span>
            
            <span class="n">extracted_contents</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Use Jina Reader API</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span><span class="p">:</span>
                        <span class="c1"># Use authenticated API for better rate limits and features</span>
                        <span class="n">jina_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://r.jina.ai/</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (compatible; AgentX/1.0)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;X-Return-Format&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span>
                        <span class="p">}</span>
                        
                        <span class="c1"># Add prompt for focused extraction</span>
                        <span class="k">if</span> <span class="n">prompt</span> <span class="ow">and</span> <span class="n">prompt</span> <span class="o">!=</span> <span class="s2">&quot;Extract the main content from this webpage&quot;</span><span class="p">:</span>
                            <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Target-Selector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt</span>
                            
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Use free API (with rate limits)</span>
                        <span class="n">jina_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://r.jina.ai/</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (compatible; AgentX/1.0)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;text/plain&#39;</span>
                        <span class="p">}</span>
                    
                    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">jina_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
                    
                    <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
                    
                    <span class="c1"># Extract title from first line if available</span>
                    <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">lines</span> <span class="ow">and</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="n">url</span>
                    
                    <span class="c1"># Remove title from content to avoid duplication</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                        <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    
                    <span class="n">web_content</span> <span class="o">=</span> <span class="n">WebContent</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                        <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                        <span class="n">markdown</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                            <span class="s2">&quot;extraction_method&quot;</span><span class="p">:</span> <span class="s2">&quot;jina_reader&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;api_authenticated&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jina_api_key</span><span class="p">),</span>
                            <span class="s2">&quot;content_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
                        <span class="p">},</span>
                        <span class="n">success</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>
                    
                    <span class="n">extracted_contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">web_content</span><span class="p">)</span>
                    
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jina Reader extraction failed for </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Add failed extraction to results</span>
                    <span class="n">failed_content</span> <span class="o">=</span> <span class="n">WebContent</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">content</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">markdown</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extraction_method&quot;</span><span class="p">:</span> <span class="s2">&quot;jina_reader&quot;</span><span class="p">},</span>
                        <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">extracted_contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">failed_content</span><span class="p">)</span>
            
            <span class="c1"># Return single content or list based on input</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">result_data</span> <span class="o">=</span> <span class="n">extracted_contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">extracted_contents</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result_data</span> <span class="o">=</span> <span class="n">extracted_contents</span>
            
            <span class="c1"># Check if any extractions succeeded</span>
            <span class="n">success</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">success</span> <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">extracted_contents</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="n">success</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;total_urls&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">url_list</span><span class="p">),</span>
                    <span class="s2">&quot;successful_extractions&quot;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">extracted_contents</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">success</span><span class="p">),</span>
                    <span class="s2">&quot;extraction_method&quot;</span><span class="p">:</span> <span class="s2">&quot;jina_reader&quot;</span>
                <span class="p">}</span>
            <span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Content extraction failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Content extraction failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;urls&quot;</span><span class="p">:</span> <span class="n">url_list</span> <span class="k">if</span> <span class="s1">&#39;url_list&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="p">[]}</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="WebTool.extract_content_with_visuals">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.WebTool.extract_content_with_visuals">[docs]</a>
    <span class="nd">@tool</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Enhanced content extraction with visual data capture using browser-use&#39;s advanced features&quot;</span><span class="p">,</span>
        <span class="n">return_description</span><span class="o">=</span><span class="s2">&quot;ToolResult containing comprehensive content including data from charts, graphs, and visual elements&quot;</span>
    <span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">extract_content_with_visuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                         <span class="n">capture_screenshot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                         <span class="n">enable_web_search</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enhanced content extraction that captures both textual and visual data from web pages.</span>
<span class="sd">        This method is specifically designed to extract data from charts, graphs, infographics,</span>
<span class="sd">        and other visual elements that traditional text extraction might miss.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            url: Single URL to extract content from (required)</span>
<span class="sd">            prompt: Detailed prompt describing what to extract, including visual elements (required)</span>
<span class="sd">            capture_screenshot: Whether to capture full-page screenshot for visual analysis, defaults to True</span>
<span class="sd">            enable_web_search: Whether to expand search beyond the URL, defaults to False</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            ToolResult with comprehensive extracted content including visual data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="s2">&quot;browser-use not available&quot;</span>
            <span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Enhanced prompt that specifically requests visual data extraction</span>
            <span class="n">enhanced_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span>
<span class="s2">            </span>
<span class="s2">            CRITICAL: Pay special attention to extracting data from visual elements including:</span>
<span class="s2">            - All statistics, percentages, and numbers shown in charts and graphs</span>
<span class="s2">            - Data from pie charts, bar charts, line graphs, and trend visualizations</span>
<span class="s2">            - Information from infographics, dashboards, and data visualizations</span>
<span class="s2">            - Table data with specific numbers and comparisons</span>
<span class="s2">            - Map data showing regional/geographic statistics</span>
<span class="s2">            - Timeline data from visual timelines and roadmaps</span>
<span class="s2">            - Competitive analysis data from comparison charts</span>
<span class="s2">            - Financial data from financial charts and projections</span>
<span class="s2">            </span>
<span class="s2">            Do not summarize visual data - extract the complete detailed information including</span>
<span class="s2">            all specific numbers, percentages, company names, dates, and quantified metrics</span>
<span class="s2">            visible in any visual elements on the page.</span>
<span class="s2">            &quot;&quot;&quot;</span>
            
            <span class="c1"># Use both Extract API and Scrape API for comprehensive data capture</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
                <span class="n">urls</span><span class="o">=</span><span class="p">[</span><span class="n">url</span><span class="p">],</span>
                <span class="n">prompt</span><span class="o">=</span><span class="n">enhanced_prompt</span><span class="p">,</span>
                <span class="n">enable_web_search</span><span class="o">=</span><span class="n">enable_web_search</span>
            <span class="p">)</span>
            
            <span class="n">visual_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">capture_screenshot</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Also capture with screenshot for visual analysis</span>
                    <span class="n">scrape_result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">scrape_url</span><span class="p">(</span>
                        <span class="n">url</span><span class="p">,</span>
                        <span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screenshot@fullPage&quot;</span><span class="p">],</span>
                        <span class="n">wait_for</span><span class="o">=</span><span class="mi">3000</span>  <span class="c1"># Wait for dynamic content to load</span>
                    <span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">scrape_result</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">scrape_result</span><span class="p">,</span> <span class="s1">&#39;screenshot&#39;</span><span class="p">):</span>
                        <span class="n">visual_data</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;screenshot_url&quot;</span><span class="p">:</span> <span class="n">scrape_result</span><span class="o">.</span><span class="n">screenshot</span><span class="p">,</span>
                            <span class="s2">&quot;markdown_content&quot;</span><span class="p">:</span> <span class="n">scrape_result</span><span class="o">.</span><span class="n">markdown</span>
                        <span class="p">}</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Screenshot capture failed for </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
                <span class="n">result_data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span>
                
                <span class="c1"># Combine extracted data with visual data if available</span>
                <span class="k">if</span> <span class="n">visual_data</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">result_data</span><span class="p">[</span><span class="s2">&quot;visual_analysis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">visual_data</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_data</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;extracted_content&quot;</span><span class="p">:</span> <span class="n">result_data</span><span class="p">,</span>
                            <span class="s2">&quot;visual_analysis&quot;</span><span class="p">:</span> <span class="n">visual_data</span>
                        <span class="p">}</span>
                
                <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                    <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">result</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
                        <span class="s2">&quot;extraction_method&quot;</span><span class="p">:</span> <span class="s2">&quot;browser_use_enhanced_visual&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;screenshot_captured&quot;</span><span class="p">:</span> <span class="n">capture_screenshot</span> <span class="ow">and</span> <span class="n">visual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;web_search_enabled&quot;</span><span class="p">:</span> <span class="n">enable_web_search</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span> <span class="ow">or</span> <span class="s2">&quot;Unknown error occurred&quot;</span>
                <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                    <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">error</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Enhanced extraction failed: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">}</span>
                <span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enhanced visual extraction failed for </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="WebTool.crawl_website">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.WebTool.crawl_website">[docs]</a>
    <span class="nd">@tool</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Crawl multiple pages from a website using browser-use&quot;</span><span class="p">,</span>
        <span class="n">return_description</span><span class="o">=</span><span class="s2">&quot;ToolResult containing list of WebContent objects from crawled pages&quot;</span>
    <span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">crawl_website</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">exclude_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crawl multiple pages from a website.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            url: The base URL to start crawling from (required)</span>
<span class="sd">            limit: Maximum number of pages to crawl, defaults to 10</span>
<span class="sd">            exclude_paths: URL paths to exclude from crawling (optional)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            ToolResult with list of WebContent objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="s2">&quot;browser-use not available&quot;</span>
            <span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">crawl_website</span><span class="p">(</span>
                <span class="n">url</span><span class="p">,</span>
                <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
                <span class="n">exclude_paths</span><span class="o">=</span><span class="n">exclude_paths</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">&quot;/admin&quot;</span><span class="p">,</span> <span class="s2">&quot;/login&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            
            <span class="c1"># Handle the CrawlStatusResponse object (Pydantic model with attributes)</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
                <span class="n">web_contents</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">WebContent</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sourceURL&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">metadata</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">metadata</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">content</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">markdown</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">markdown</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">markdown</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">metadata</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{},</span>
                        <span class="n">success</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span> <span class="ow">or</span> <span class="p">[])</span>
                <span class="p">]</span>
                
                <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                    <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">result</span><span class="o">=</span><span class="n">web_contents</span><span class="p">,</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;base_url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="s2">&quot;pages_crawled&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">web_contents</span><span class="p">)}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown error occurred&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                    <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">error</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Browser-use crawl failed: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;base_url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">}</span>
                <span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Website crawl failed for </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="p">)</span></div>

    
<div class="viewcode-block" id="WebTool.automate_browser">
<a class="viewcode-back" href="../../../api/agentx/builtin_tools/web/index.html#agentx.builtin_tools.WebTool.automate_browser">[docs]</a>
    <span class="nd">@tool</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Automate browser actions using natural language with browser-use&quot;</span><span class="p">,</span>
        <span class="n">return_description</span><span class="o">=</span><span class="s2">&quot;ToolResult containing browser action result with success status and data&quot;</span>
    <span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">automate_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instruction</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform browser automation using natural language instructions.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            instruction: Natural language instruction for browser action (required)</span>
<span class="sd">            url: Optional URL to navigate to first</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            ToolResult with BrowserAction containing action result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="s2">&quot;browser-use not available&quot;</span>
            <span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start browser session</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">page</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
            
            <span class="c1"># Navigate to URL if provided</span>
            <span class="k">if</span> <span class="n">url</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            
            <span class="c1"># Perform AI action</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">ai_action</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>
            
            <span class="n">browser_action</span> <span class="o">=</span> <span class="n">BrowserAction</span><span class="p">(</span>
                <span class="n">action</span><span class="o">=</span><span class="n">instruction</span><span class="p">,</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="n">result</span>
            <span class="p">)</span>
            
            <span class="c1"># Close browser</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="n">browser_action</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;instruction&quot;</span><span class="p">:</span> <span class="n">instruction</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">}</span>
            <span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Browser automation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="c1"># Ensure browser is closed</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_with_jina</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fallback content extraction using Jina Reader.</span>
<span class="sd">        More reliable than Firecrawl for many websites.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
            
            <span class="c1"># Jina Reader API - free and reliable</span>
            <span class="n">jina_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://r.jina.ai/</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span>
            
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (compatible; AgentX/1.0; +https://github.com/agentx)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;text/plain&#39;</span>
            <span class="p">}</span>
            
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">jina_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
            
            <span class="c1"># Extract title from first line if available</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">lines</span> <span class="k">else</span> <span class="n">url</span>
            
            <span class="n">web_content</span> <span class="o">=</span> <span class="n">WebContent</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">markdown</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extraction_method&quot;</span><span class="p">:</span> <span class="s2">&quot;jina_reader&quot;</span><span class="p">},</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="n">web_content</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="s2">&quot;extraction_method&quot;</span><span class="p">:</span> <span class="s2">&quot;jina_reader&quot;</span><span class="p">}</span>
            <span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jina Reader extraction failed for </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Jina Reader extraction failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">}</span>
            <span class="p">)</span></div>



<span class="c1"># Export main classes and functions</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;WebTool&quot;</span><span class="p">,</span>
    <span class="s2">&quot;WebContent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BrowserAction&quot;</span><span class="p">,</span>
<span class="p">]</span> 
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, AgentX Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>