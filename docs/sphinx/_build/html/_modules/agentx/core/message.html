

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>agentx.core.message &mdash; AgentX 0.13.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=ec68e10f"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            AgentX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AgentX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">agentx.core.message</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for agentx.core.message</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">TYPE_CHECKING</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..utils.id</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_short_id</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.tool</span><span class="w"> </span><span class="kn">import</span> <span class="n">ToolCall</span>

<span class="c1"># This file defines the core data structures for the AgentX framework,</span>
<span class="c1"># as specified in design document 03-data-and-events.md.</span>

<span class="c1"># --- Core Data Structures ---</span>

<span class="c1"># Note: ToolCall and ToolResult are defined in core.tool, not here. This separation is intentional:</span>
<span class="c1"># - ToolCall/ToolResult = tool execution models (core.tool)</span>
<span class="c1"># - ToolCallPart/ToolResultPart = conversation representations (here in message.py)</span>
<span class="c1"># The conversation parts are self-contained and don&#39;t depend on tool execution models</span>

<div class="viewcode-block" id="Artifact">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.Artifact">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Artifact</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Artifact reference with versioning and metadata.&quot;&quot;&quot;</span>
    <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># e.g., &quot;file://artifacts/main.py&quot;</span>
    <span class="n">mime_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">size_bytes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># For artifact versioning</span>
    <span class="n">checksum</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># For integrity verification</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>  <span class="c1"># Extensible metadata</span>
    <span class="n">created_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Agent or tool that created it</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># For categorization and search</span></div>


<span class="c1"># --- TaskStep and its Parts ---</span>

<div class="viewcode-block" id="TextPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.TextPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TextPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Text content part with language and confidence support.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">language</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># For multilingual support</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># LLM confidence score</span></div>


<div class="viewcode-block" id="ToolCallPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.ToolCallPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ToolCallPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool call request part - conversation representation.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;tool_call&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tool_call&quot;</span>
    <span class="n">tool_call_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">expected_output_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="ToolResultPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.ToolResultPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ToolResultPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool execution result part.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;tool_result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tool_result&quot;</span>
    <span class="n">tool_call_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">is_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="ArtifactPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.ArtifactPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ArtifactPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Artifact reference part.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;artifact&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;artifact&quot;</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="n">Artifact</span></div>


<div class="viewcode-block" id="ImagePart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.ImagePart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ImagePart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Image content part with metadata.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;image&quot;</span>
    <span class="n">image_url</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Can be data URL or artifact reference</span>
    <span class="n">alt_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dimensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># width, height</span>
    <span class="nb">format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># png, jpg, etc.</span></div>


<div class="viewcode-block" id="AudioPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.AudioPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AudioPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Audio content part with metadata.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;audio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;audio&quot;</span>
    <span class="n">audio_url</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Can be data URL or artifact reference</span>
    <span class="n">transcript</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">duration_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># mp3, wav, etc.</span>
    <span class="n">sample_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="MemoryReference">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.MemoryReference">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MemoryReference</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Memory reference with relevance scoring.&quot;&quot;&quot;</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">memory_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;short_term&quot;, &quot;long_term&quot;, &quot;semantic&quot;, &quot;episodic&quot;</span>
    <span class="n">relevance_score</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">retrieval_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="MemoryPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.MemoryPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MemoryPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Memory operation part.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;memory&quot;</span>
    <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;store&quot;, &quot;retrieve&quot;, &quot;search&quot;, &quot;consolidate&quot;</span>
    <span class="n">references</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryReference</span><span class="p">]</span>
    <span class="n">content</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GuardrailCheck">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.GuardrailCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GuardrailCheck</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Individual guardrail check result.&quot;&quot;&quot;</span>
    <span class="n">check_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">check_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;input_validation&quot;, &quot;content_filter&quot;, &quot;rate_limit&quot;, &quot;policy&quot;</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;passed&quot;, &quot;failed&quot;, &quot;warning&quot;</span>
    <span class="n">message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">policy_violated</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># &quot;low&quot;, &quot;medium&quot;, &quot;high&quot;, &quot;critical&quot;</span></div>


<div class="viewcode-block" id="GuardrailPart">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.GuardrailPart">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GuardrailPart</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Guardrail check results part.&quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;guardrail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;guardrail&quot;</span>
    <span class="n">checks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">GuardrailCheck</span><span class="p">]</span>
    <span class="n">overall_status</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;passed&quot;, &quot;failed&quot;, &quot;warning&quot;</span></div>


<span class="n">ConversationPart</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextPart</span><span class="p">,</span> <span class="n">ToolCallPart</span><span class="p">,</span> <span class="n">ToolResultPart</span><span class="p">]</span>

<div class="viewcode-block" id="TaskStep">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.TaskStep">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TaskStep</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single step in a task&#39;s conversation history.&quot;&quot;&quot;</span>
    <span class="n">step_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;step_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">parts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ConversationPart</span><span class="p">]</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span></div>


<span class="c1"># --- Standard Chat Message Format (compatible with Vercel AI SDK) ---</span>

<div class="viewcode-block" id="Message">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.Message">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Message</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Standard chat message format compatible with LLM APIs and Vercel AI SDK.</span>
<span class="sd">    </span>
<span class="sd">    This follows the industry standard format with role/content/parts structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">generate_short_id</span><span class="p">)</span>
    <span class="n">role</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;tool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># Backward compatibility - text content</span>
    <span class="n">parts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ConversationPart</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># Modern structured content</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
    
<div class="viewcode-block" id="Message.user_message">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.Message.user_message">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">user_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ConversationPart</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a user message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">parts</span><span class="o">=</span><span class="n">parts</span> <span class="ow">or</span> <span class="p">[</span><span class="n">TextPart</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">content</span><span class="p">)]</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="Message.assistant_message">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.Message.assistant_message">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assistant_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ConversationPart</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an assistant message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;assistant&quot;</span><span class="p">,</span> 
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">parts</span><span class="o">=</span><span class="n">parts</span> <span class="ow">or</span> <span class="p">[</span><span class="n">TextPart</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">content</span><span class="p">)]</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="Message.system_message">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.Message.system_message">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">system_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ConversationPart</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a system message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> 
            <span class="n">parts</span><span class="o">=</span><span class="n">parts</span> <span class="ow">or</span> <span class="p">[</span><span class="n">TextPart</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">content</span><span class="p">)]</span>
        <span class="p">)</span></div>
</div>


<div class="viewcode-block" id="UserMessage">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.UserMessage">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">UserMessage</span><span class="p">(</span><span class="n">Message</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;User message - alias for Message with role=&#39;user&#39;.&quot;&quot;&quot;</span>
    <span class="n">role</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span></div>


<div class="viewcode-block" id="MessageQueue">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.MessageQueue">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MessageQueue</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Queue for managing message flow in tasks.&quot;&quot;&quot;</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">max_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span>
    
<div class="viewcode-block" id="MessageQueue.add">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.MessageQueue.add">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a message to the queue.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Remove oldest message</span></div>

    
<div class="viewcode-block" id="MessageQueue.get_all">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.MessageQueue.get_all">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all messages in the queue.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="MessageQueue.clear">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.MessageQueue.clear">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear all messages from the queue.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
</div>


<div class="viewcode-block" id="TaskHistory">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.TaskHistory">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TaskHistory</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task execution history with messages and metadata.&quot;&quot;&quot;</span>
    <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">TaskStep</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
    <span class="n">updated_at</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
    
<div class="viewcode-block" id="TaskHistory.add_message">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.TaskHistory.add_message">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a message to the history.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updated_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TaskHistory.add_step">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.TaskHistory.add_step">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">TaskStep</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a task step to the history.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updated_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span></div>
</div>


<span class="c1"># --- Streaming Models ---</span>

<div class="viewcode-block" id="StreamChunk">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.StreamChunk">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StreamChunk</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Token-by-token message streaming from LLM.</span>
<span class="sd">    </span>
<span class="sd">    This is Channel 1 of the dual-channel system - provides low-latency</span>
<span class="sd">    UI updates for &quot;typing&quot; effect. This is message streaming, not events.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;content_chunk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;content_chunk&quot;</span>
    <span class="n">step_id</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Links to the TaskStep being generated</span>
    <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">is_final</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># True for the last chunk of a response</span>
    <span class="n">token_count</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">)</span></div>


<div class="viewcode-block" id="StreamError">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.StreamError">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StreamError</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Error in message streaming.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;stream_error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stream_error&quot;</span>
    <span class="n">step_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">)</span></div>


<div class="viewcode-block" id="StreamComplete">
<a class="viewcode-back" href="../../../api/agentx/core/message/index.html#agentx.core.StreamComplete">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StreamComplete</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Message streaming completion marker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;stream_complete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stream_complete&quot;</span>
    <span class="n">step_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">)</span></div>



 
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, AgentX Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>